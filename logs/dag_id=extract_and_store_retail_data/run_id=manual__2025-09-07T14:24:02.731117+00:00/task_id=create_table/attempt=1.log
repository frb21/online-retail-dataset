{"timestamp":"2025-09-07T14:24:03.847795","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-07T14:24:03.848483","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/pipeline.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-07T14:24:03.904708Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-07T14:24:03.904998Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-07T14:24:03.905214Z","level":"info","event":"Current task name:create_table","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-07T14:24:03.905402Z","level":"info","event":"Dag name:extract_and_store_retail_data","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-07T14:24:03.904278","level":"info","event":"Executing: \n    CREATE TABLE IF NOT EXISTS retail_transactions (\n        InvoiceNo VARCHAR(20) NOT NULL,\n        StockCode VARCHAR(20) NOT NULL,\n        Description TEXT,\n        Quantity INTEGER NOT NULL,\n        InvoiceDate TIMESTAMP NOT NULL,\n        UnitPrice NUMERIC(10, 4) NOT NULL,\n        CustomerID INTEGER,\n        Country VARCHAR(50),\n        TotalPrice NUMERIC(12, 4),\n        PRIMARY KEY (InvoiceNo, StockCode)\n    );","logger":"airflow.task.operators.airflow.providers.common.sql.operators.sql.SQLExecuteQueryOperator"}
{"timestamp":"2025-09-07T14:24:03.907900","level":"warning","event":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py:471: DeprecationWarning: Using Connection.get_connection_from_secrets from `airflow.models` is deprecated.Please use `get` on Connection from sdk(`airflow.sdk.Connection`) instead\n  warnings.warn(\n","logger":"py.warnings"}
{"timestamp":"2025-09-07T14:24:03.919395","level":"info","event":"Connection Retrieved 'retail_connection'","logger":"airflow.hooks.base"}
{"timestamp":"2025-09-07T14:24:03.927650","level":"info","event":"Connection Retrieved 'retail_connection'","logger":"airflow.hooks.base"}
{"timestamp":"2025-09-07T14:24:03.928264","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"OperationalError","exc_value":"connection to server at \"172.18.0.4\", port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":920,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1215,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/operators/sql.py","lineno":312,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/hooks/sql.py","lineno":763,"name":"run"},{"filename":"/usr/local/lib/python3.12/contextlib.py","lineno":137,"name":"__enter__"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/hooks/sql.py","lineno":870,"name":"_create_autocommit_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/postgres/hooks/postgres.py","lineno":183,"name":"get_conn"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/__init__.py","lineno":122,"name":"connect"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-09-07T14:24:03.953778Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-07T14:24:03.954148Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-07T14:24:03.954430Z","level":"info","event":"Task:<Task(SQLExecuteQueryOperator): create_table>","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-07T14:24:03.954851Z","level":"info","event":"Failure caused by connection to server at \"172.18.0.4\", port 5432 failed: Connection refused","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-07T14:24:03.955104Z","level":"info","event":"\tIs the server running on that host and accepting TCP/IP connections?","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-07T14:24:03.955342Z","level":"info","event":"","chan":"stdout","logger":"task"}
